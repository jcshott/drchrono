{% extends "medications/base.html" %}

{% block content %}
<div>
    <h2> Current Patients with Prescriptions </h2>
    {% for patient in patient_info %}
    {% if patient.current_meds %}
    <div class="card-block" style="width: 22rem;">
        <div class="card">
        <h4 class="card-title text-xs-center">{{ patient.name }}</h4>
        <p class="card-text">Some text about patient </p>

        <button class="btn btn-primary medButton" type="button" data-toggle="collapse" data-target="#medicationInfo{{ patient.id }}" aria-expanded="false" aria-controls="collapseExample">
          Click for Medication Options
        </button>

        <div class="collapse" id="medicationInfo{{ patient.id }}">
            <div class="card card-block">

            <ul class="meds">
                {% for med in patient.current_meds %}
                <li> Name: {{ med.med_name }}

                <li class="{{ med.med_id }}"> Refills Remaining <span id="remaining-{{ med.med_id }}"> {{ med.refills }} </span> </li>
                    {% if med.refills < 2 %}
                    <button class="btn btn-primary renewButton" id="renew-{{ med.med_id }}" data-toggle="modal" data-target="#renewModal" data-id="{{ med.med_id}}"> renew options for this Rx </button>
                    {% endif %}

                    {% if med.refills > 0 %}
                    <form action="" method="post" id="refillForm">
                        {% csrf_token %}
                        <input type="hidden" name="med_id" id="refill-{{ med.med_id }}" value="{{ med.med_id }}"></input>
                        <input type="submit" value="Refill this Rx" class="refillButton" id="button-{{ med.med_id }}"/>
                    </form>

                    <!-- <button class="btn btn-primary refillButton" id="refill-{{ med.med_id }}"> refill this Rx </button> -->
                    {% endif %}

                </li>
                {% endfor %}
            <ul>
                {% endif %}
            </div>
        </div>
      </div>
    </div>
    {% endfor %}

    </div>
<!-- modal with form for renewing -->

<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" id="renewModal">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">

        </div>
    </div>
</div>


</div>

{% endblock %}
